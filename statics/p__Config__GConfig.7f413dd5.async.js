"use strict";(self.webpackChunkpity=self.webpackChunkpity||[]).push([[3131],{51270:function(F,f,e){var E=e(42281),d=e(48658),y=e(209),s=e(59740),v=function(C,u){return d.createElement(s.Z,(0,E.Z)((0,E.Z)({},C),{},{ref:u,icon:y.Z}))};v.displayName="PlusOutlined",f.Z=d.forwardRef(v)},20970:function(F,f,e){var E=e(1619),d=e.n(E),y=e(92105),s=e.n(y),v=e(48658),c=e(64216),C=e(63368),u=e(70214),j=e(21577),l=e(93251),B=c.Z.Item,x=function(r){var S=r.title,H=r.width,I=r.left,T=r.right,G=r.formName,L=r.record,R=r.onFinish,p=r.loading,N=r.fields,V=r.open,U=r.onCancel,W=r.offset,K=W===void 0?0:W,k=r.children,Z=r.Footer,z=r.onTest,n=c.Z.useForm(),O=s()(n,1),P=O[0],M=function(){P.validateFields().then(function(m){R(m)})};(0,v.useEffect)(function(){P.resetFields(),P.setFieldsValue(L)},[L]);var g={labelCol:{span:I},wrapperCol:{span:T}};return(0,l.jsxs)(C.Z,{style:{marginTop:K},confirmLoading:p,footer:Z!==void 0?(0,l.jsx)(Z,{onOk:M,onCancel:U,onTest:function(){P.validateFields().then(function(m){z(m)})}}):void 0,title:S,width:H,open:V,onOk:M,onCancel:U,children:[k||null,(0,l.jsx)(c.Z,d()(d()({form:P},g),{},{name:G,initialValues:L,onFinish:R,children:N.map(function(a,m){return(0,l.jsx)(u.Z,{span:a.span||24,children:(0,l.jsx)(B,{label:a.label,colon:a.colon||!0,initialValue:a.initialValue,rules:[{required:a.required,message:a.message}],name:a.name,valuePropName:a.valuePropName||"value",children:(0,j.Z)(a.type,a.placeholder,a.component)})},m)})}))]})};f.Z=x},21577:function(F,f,e){var E=e(32224),d=e(82511),y=e(48658),s=e(93251),v=E.Z.TextArea,c=function(u,j){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return l||(u==="input"?(0,s.jsx)(E.Z,{placeholder:j}):u==="textarea"?(0,s.jsx)(v,{placeholder:j}):u==="switch"?(0,s.jsx)(d.Z,{}):null)};f.Z=c},39591:function(F,f,e){e.r(f);var E=e(1619),d=e.n(E),y=e(14660),s=e.n(y),v=e(21464),c=e.n(v),C=e(92105),u=e.n(C),j=e(42096),l=e(22666),B=e(33228),x=e(63368),Q=e(49776),r=e(60020),S=e(82511),H=e(78890),I=e(81386),T=e(70214),G=e(70940),L=e(32224),R=e(86061),p=e(48658),N=e(9350),V=e(51270),U=e(20970),W=e(95615),K=e(20077),k=e(45231),Z=e(94519),z=e(12087),n=e(93251),O=l.Z.Option,P=function(g){var a=g.gconfig,m=g.user,oe=g.loading,h=g.dispatch,re=a.data,X=a.envList,w=a.key_type,le=a.envMap,se=a.modal,D=a.currentEnv,$=a.name,b=a.pagination,ie=m.userMap,ue=(0,p.useState)({id:0,key_type:0}),q=u()(ue,2),Y=q[0],ee=q[1],de=(0,p.useState)(0),ne=u()(de,2),te=ne[0],_e=ne[1],Ee=(0,p.useState)(null),ae=u()(Ee,2),Me=ae[0],ce=ae[1],me=function(){return te===1||te===2?"yaml":"text"},fe=[{title:"\u73AF\u5883",key:"env",dataIndex:"env",render:function(t){return(0,n.jsx)(B.Z,{children:le[t]})}},{title:"\u7C7B\u578B",dataIndex:"key_type",key:"key_type",render:function(t){return(0,n.jsx)(B.Z,{color:z.Z.CONFIG_TYPE_TAG[w[t]],children:w[t]})}},{title:"key",dataIndex:"key",key:"keyword"},{title:"value",dataIndex:"value",key:"value",render:function(t,o){if(o.key_type===0)return t;if(o.key_type===1)return(0,n.jsx)("a",{onClick:function(){x.Z.info({title:"".concat(o.key),width:500,bodyStyle:{padding:-12},content:(0,n.jsx)(K.Z,{language:"json",style:W.BV,children:o.value})})},children:"\u67E5\u770B"});if(o.key_type===2)return(0,n.jsx)("a",{onClick:function(){x.Z.info({title:"".concat(o.key),width:500,bodyStyle:{padding:-12},content:(0,n.jsx)(K.Z,{language:"yaml",style:W.BV,children:o.value})})},children:"\u67E5\u770B"})}},{title:"\u662F\u5426\u53EF\u7528",dataIndex:"enable",key:"enable",render:function(t){return(0,n.jsx)(Q.Z,{status:t?"processing":"default",text:t?"\u4F7F\u7528\u4E2D":"\u5DF2\u7981\u6B62"})}},{title:"\u521B\u5EFA\u4EBA",key:"create_user",render:function(t,o){return(0,n.jsx)(k.Z,{user:ie[o.create_user.toString()]})}},{title:"\u64CD\u4F5C",key:"operation",render:function(t,o){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{onClick:function(){A({modal:!0}),ee(o),_e(o.key_type)},children:"\u7F16\u8F91"}),(0,n.jsx)(r.Z,{type:"vertical"}),(0,n.jsx)("a",{onClick:function(){h({type:"gconfig/deleteGConfig",payload:{id:o.id}})},children:"\u5220\u9664"})]})}}],ve=[{name:"env",label:"\u73AF\u5883",required:!0,component:(0,n.jsx)(l.Z,{defaultValue:D,placeholder:"\u9009\u62E9\u5BF9\u5E94\u73AF\u5883",children:X.map(function(_){return(0,n.jsx)(O,{value:_.id,children:_.name})})}),type:"select"},{name:"key_type",label:"\u7C7B\u578B",required:!0,component:(0,n.jsxs)(l.Z,{onSelect:function(t){_e(t)},children:[(0,n.jsx)(O,{value:0,children:"String"}),(0,n.jsx)(O,{value:1,children:"JSON"}),(0,n.jsx)(O,{value:2,children:"YAML"})]}),type:"select"},{name:"key",label:"key",required:!0,type:"input",placeholder:"\u8BF7\u8F93\u5165key"},{name:"value",label:"value",required:!0,component:(0,n.jsx)(Z.Z,{language:me(),setEditor:ce,height:250})},{name:"enable",label:"\u662F\u5426\u53EF\u7528",required:!0,component:(0,n.jsx)(S.Z,{}),valuePropName:"checked",initialValue:!0}],ge=function(){var _=c()(s()().mark(function t(){return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,h({type:"gconfig/fetchEnvList",payload:{page:1,size:1e4}});case 2:case"end":return i.stop()}},t)}));return function(){return _.apply(this,arguments)}}(),pe=function(){h({type:"user/fetchUserList"})},Oe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b.current,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:b.pageSize;h({type:"gconfig/fetchGConfig",payload:{page:t,size:o,env:D||"",key:$}})};(0,p.useEffect)(function(){ge()},[]),(0,p.useEffect)(function(){pe(),Oe()},[D,$,b.current]);var Pe=function(){var _=c()(s()().mark(function t(o){var i;return s()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:i=d()(d()({},Y),o),Y.id===0?h({type:"gconfig/insertConfig",payload:i}):h({type:"gconfig/updateGConfig",payload:i});case 2:case"end":return J.stop()}},t)}));return function(o){return _.apply(this,arguments)}}(),A=function(t){h({type:"gconfig/save",payload:t})};return(0,n.jsx)(j._z,{title:"\u5168\u5C40\u53D8\u91CF",breadcrumb:null,children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(U.Z,{fields:ve,open:se,left:4,right:20,onFinish:Pe,onCancel:function(){A({modal:!1})},title:"\u7F16\u8F91\u53D8\u91CF",record:Y,width:600,offset:-60}),(0,n.jsxs)(I.Z,{gutter:[8,8],children:[(0,n.jsx)(T.Z,{span:12,children:(0,n.jsxs)(G.ZP,{type:"primary",onClick:function(){A({modal:!0}),ee({id:0,key_type:0,env:D!==null?D.toString():D})},children:[(0,n.jsx)(V.Z,{}),"\u6DFB\u52A0\u53D8\u91CF"]})}),(0,n.jsx)(T.Z,{span:4}),(0,n.jsx)(T.Z,{span:8,children:(0,n.jsx)(L.Z,{addonBefore:(0,n.jsx)(l.Z,{allowClear:!0,placeholder:"\u9009\u62E9\u5BF9\u5E94\u73AF\u5883",value:D,style:{width:120},onChange:function(t){A({currentEnv:t})},children:X.map(function(_){return(0,n.jsx)(O,{value:_.id.toString(),children:_.name})})}),placeholder:"\u8BF7\u8F93\u5165key",value:$,onChange:function(t){A({name:t.target.value})}})})]}),(0,n.jsx)(I.Z,{style:{marginTop:12},children:(0,n.jsx)(T.Z,{span:24,children:(0,n.jsx)(R.Z,{dataSource:re,columns:fe,pagination:b,rowKey:function(t){return t.id},loading:oe.effects["gconfig/fetchGConfig"],onChange:function(t){A({pagination:t})}})})})]})})};f.default=(0,N.connect)(function(M){var g=M.gconfig,a=M.user,m=M.loading;return{gconfig:g,user:a,loading:m}})(P)}}]);
