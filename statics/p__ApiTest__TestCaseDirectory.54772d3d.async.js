"use strict";(self.webpackChunkpity=self.webpackChunkpity||[]).push([[5570],{16672:function(Ct,de,t){var he=t(22666),fe=t(29303),Ee=t(12087),B=t(48658),ie=t(93251),h=he.Z.Option;de.Z=function(se){var M=se.users,ve=se.placeholder,d=ve===void 0?"\u8BF7\u9009\u62E9\u4EBA\u5458":ve,De=se.onChange,Te=se.value,le=se.mode,z=le===void 0?null:le;return(0,ie.jsx)(he.Z,{allowClear:!0,onChange:De,value:Te,showSearch:!0,placeholder:d,mode:z,filterOption:function(ae,oe){return oe.props.children[2].toLowerCase().indexOf(ae.toLowerCase())>-1||oe.props.children[4].toLowerCase().indexOf(ae.toLowerCase())>-1},children:M.map(function(Y){return(0,ie.jsxs)(h,{value:Y.id,children:[(0,ie.jsx)(fe.C,{size:14,src:Y.avatar||Ee.Z.AVATAR_URL})," ",Y.name,"(",Y.email,")"]},Y.id)})})}},22911:function(Ct,de,t){t.r(de),t.d(de,{default:function(){return gr}});var he=t(53272),fe=t.n(he),Ee=t(1619),B=t.n(Ee),ie=t(14660),h=t.n(ie),se=t(21464),M=t.n(se),ve=t(92105),d=t.n(ve),De=t(42096),Te=t(48728),le=t(22666),z=t(64216),Y=t(63368),ae=t(78890),oe=t(84325),te=t(34245),Be=t(33228),Ft=t(49776),St=t(60020),pe=t(28067),Ne=t(5545),ye=t(40097),Zt=t(35019),Et=t(68575),re=t(81386),$e=t(50930),N=t(70940),G=t(70214),Dt=t(29303),Tt=t(59438),me=t(32224),ke=t(86061),ge=t(9350),i=t(48658),Bt=t(45403),At=t(67355),He=t(86782),Pt=t(13178),Ot=t(52753),Ue=t(22954),Ae=t(51270),Rt=t(98839),Lt=t(74814),Mt=t(74562),ze=t(28657),xe=t(59918),It=t(25802),wt=t(71372),dn=t(25285),Ve=t(52538),We=t(20970),je=t(12087),Kt=t(89148),be=t(10571),Nt=t(45231),$t=t(69775),kt=t(16672),Ht=t(71243),Ut=t(50867),zt=t(90837),e=t(93251),Ge=[],Vt=function(c){var a=c.treeData,o=c.blockNode,C=o===void 0?!0:o,O=c.onAddNode,$=c.menu,V=c.selectedKeys,f=c.onSelect,k=c.addDirectory,R=function S(g){for(var j=0;j<g.length;j++){var Z=g[j],w=Z.key,K=Z.title;Ge.push({key:w,title:K}),Z.children&&S(Z.children)}},U=function S(g,j){for(var Z,w=0;w<j.length;w++){var K=j[w];K.children&&(K.children.some(function(ne){return ne.key===g})?Z=K.key:S(g,K.children)&&(Z=S(g,K.children)))}return Z};R(a);var J=(0,i.useState)([]),X=d()(J,2),H=X[0],v=X[1],I=(0,i.useState)(""),q=d()(I,2),W=q[0],Q=q[1],_=(0,i.useState)(!0),D=d()(_,2),u=D[0],l=D[1],y=(0,i.useState)(null),E=d()(y,2),A=E[0],L=E[1],P=function(g){v(g),l(!1)},b=function(g){var j=g.target.value,Z=Ge.map(function(w){return w.title.indexOf(j)>-1?U(w.key,a):null}).filter(function(w,K,ne){return w&&ne.indexOf(w)===K});v(Z),Q(j),l(!0)},F=function S(g){return g.map(function(j){var Z=j.title.indexOf(W),w=j.title.substr(0,Z),K=j.title.substr(Z+W.length),ne=Z>-1?(0,e.jsxs)("span",{children:[w,(0,e.jsx)("span",{className:"site-tree-search-value",children:W}),K]}):(0,e.jsx)("span",{children:j.title});return j.children?{title:ne,key:j.key,children:S(j.children)}:{title:ne,key:j.key}})};return(0,e.jsxs)("div",{children:[(0,e.jsxs)(re.Z,{gutter:8,children:[(0,e.jsx)(G.Z,{span:18,children:(0,e.jsx)(me.Z,{size:"small",className:"treeSearch",placeholder:"\u8F93\u5165\u8981\u67E5\u627E\u7684\u76EE\u5F55",onChange:b,prefix:(0,e.jsx)(xe.Z,{})})}),(0,e.jsx)(G.Z,{span:6,children:k})]}),(0,e.jsx)(Ht.Z,{onExpand:P,defaultExpandAll:!0,blockNode:C,selectedKeys:V,onSelect:f,expandedKeys:H,autoExpandParent:u,treeData:F(a),titleRender:function(g){return(0,e.jsxs)("div",{onMouseOver:function(){return L(g.key)},onMouseLeave:function(){return L(null)},children:[(0,e.jsx)(zt.Z,{theme:"outline",size:"15",className:"folder"}),g.title,A===g.key?(0,e.jsxs)("span",{className:"suffixButton",children:[(0,e.jsx)(Ae.Z,{onClick:function(Z){Z.stopPropagation(),O(g)},className:"icon-left"}),(0,e.jsx)(pe.Z,{overlay:$(g),trigger:"click",children:(0,e.jsx)(Ut.Z,{className:"icon-right",onClick:function(Z){Z.stopPropagation()}})})]}):null]})}})]})},Je=t(14189),Wt=function(a){return(0,e.jsx)(ae.Z,B()(B()({},a),{},{bodyStyle:{height:"100%",overflowX:"hidden"},children:a.hideOverflowX?(0,e.jsx)(Je.$B,{autoHide:!0,autoHideTimeout:1e3,renderTrackHorizontal:function(C){return(0,e.jsx)("div",B()(B()({},C),{},{style:{display:C.hideOverflowX?"hidden":"block"},className:"track-horizontal"}))},autoHideDuration:200,style:{width:"100%",height:"inherit"},children:a.children}):(0,e.jsx)(Je.$B,{autoHide:!0,autoHideTimeout:1e3,autoHideDuration:200,style:{width:"100%",height:"inherit"},children:a.children})}))},Xe=(0,i.memo)(Wt),bt=t(5463),Gt=t(19895),Jt=t(90172),hn=t(43811),Qe=t(22070),Xt=function(a){var o=a.dispatch,C=a.testcase,O=a.directory_id,$=a.bodyType,V=a.setBodyType,f=a.formData,k=a.setFormData,R=a.body,U=a.setBody,J=a.headers,X=a.setHeaders,H=a.onSubmit,v=a.form,I=C.caseInfo,q=C.editing,W=C.constructRecord,Q=C.constructorModal,_=(0,i.useState)(!1),D=d()(_,2),u=D[0],l=D[1],y=(0,i.useState)({}),E=d()(y,2),A=E[0],L=E[1],P=z.Z.useForm(),b=d()(P,1),F=b[0],S=(0,i.useState)(!1),g=d()(S,2),j=g[0],Z=g[1];return(0,i.useEffect)(function(){o({type:"testcase/queryTestcaseDirectory",payload:{directory_id:O}}),o({type:"gconfig/fetchEnvList",payload:{page:1,exactly:!0}}),o({type:"user/fetchUserList"})},[]),(0,i.useEffect)(function(){X(Qe.Z.parseHeaders(I.request_headers)),U(I.body),V(I.body_type)},[I,q]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(be.Z,{width:1e3,modal:u,setModal:l,response:A,caseName:I.name,single:!1}),(0,e.jsx)(re.Z,{children:(0,e.jsxs)(G.Z,{span:24,children:[(0,e.jsx)(Jt.Z,{width:1050,modal:Q,setModal:function(K){o({type:"testcase/save",payload:{constructorModal:K}})},form:F,record:W,createMode:!0,suffix:j}),(0,e.jsx)(Gt.Z,{directoryId:O,form:v,body:R,setBody:U,create:!0,formData:f,setFormData:k,bodyType:$,setBodyType:V,setSuffix:Z,headers:J,setHeaders:X,onSubmit:H})]})})]})},Qt=(0,ge.connect)(function(c){var a=c.user,o=c.testcase,C=c.loading,O=c.gconfig;return{testcase:o,user:a,loading:C,gconfig:O}})(Xt),Pe=t(58385),Ye=t(52577),Yt=t(39795),qt=t(13309),_t=t(57445),er=t.n(_t),tr=t(20077),rr=t(95615),nr=t(36334),sr=t(50643),ar=t.n(sr),or=["dataSource","dispatch","loading"],qe=function(a){switch(a.toUpperCase()){case"GET":return{color:"rgb(235, 249, 244)",fontColor:"rgb(47, 177, 130)"};case"POST":return{color:"rgb(242, 244, 248)",fontColor:"rgb(5, 112, 175)"};case"PUT":return{color:"rgb(255, 247, 230)",fontColor:"rgb(255, 174, 0)"};case"DELETE":return{color:"rgb(253, 244, 246)",fontColor:"rgb(222, 72, 108)"};default:return{color:"rgb(243, 251, 254)",fontColor:"rgb(166, 187, 210)"}}},ur=function(a){var o=a.color,C=a.text,O=a.fontColor;return(0,e.jsx)(Be.Z,{style:{color:O,borderRadius:12,padding:"0 12px"},color:o,children:C})},Ce=function(a){var o=a.name,C=a.record;return(0,e.jsx)("a",{onClick:function(){Y.Z.info({title:o,width:700,bodyStyle:{padding:-12},content:(0,e.jsx)(tr.Z,{language:"json",style:rr.BV,children:C[o]})})},children:"\u8BE6\u7EC6"})},ir=function(a){var o=a.dataSource,C=a.dispatch,O=a.loading,$=er()(a,or),V=(0,i.useState)(""),f=d()(V,2),k=f[0],R=f[1],U=(0,i.useState)(""),J=d()(U,2),X=J[0],H=J[1],v=(0,i.useRef)(null),I=function(u,l,y){l(),R(u[0]),H(y)},q=function(u){u(),R("")},W=function(u){return{filterDropdown:function(y){var E=y.setSelectedKeys,A=y.selectedKeys,L=y.confirm,P=y.clearFilters;return(0,e.jsxs)("div",{style:{padding:8},children:[(0,e.jsx)(me.Z,{ref:v,placeholder:"\u641C\u7D22 ".concat(u),value:A[0],onChange:function(F){return E(F.target.value?[F.target.value]:[])},onPressEnter:function(){return I(A,L,u)},style:{marginBottom:8,display:"block"}}),(0,e.jsxs)(Ye.Z,{children:[(0,e.jsx)(N.ZP,{type:"primary",onClick:function(){return I(A,L,u)},icon:(0,e.jsx)(xe.Z,{}),size:"small",style:{width:90},children:"\u67E5\u627E"}),(0,e.jsx)(N.ZP,{onClick:function(){return P&&q(P)},size:"small",style:{width:90},children:"\u91CD\u7F6E"}),(0,e.jsx)(N.ZP,{type:"link",size:"small",onClick:function(){L({closeDropdown:!1}),R(A[0]),H(u)},children:"\u8FC7\u6EE4"})]})]})},filterIcon:function(y){return(0,e.jsx)(xe.Z,{style:{color:y?"#1890ff":void 0}})},onFilter:function(y,E){return E[u].toString().toLowerCase().includes(y.toLowerCase())},onFilterDropdownVisibleChange:function(y){y&&setTimeout(function(){var E;return(E=v.current)===null||E===void 0?void 0:E.select()},100)},ellipsis:!0,render:function(y){return X===u?(0,e.jsx)(ye.Z,{title:y,children:(0,e.jsx)(ar(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[k],autoEscape:!0,textToHighlight:y?y.toString():""})}):(0,e.jsx)(ye.Z,{title:y,children:(0,e.jsx)("a",{href:y,children:y.slice(0,48)})})}}},Q=function(u){C({type:"recorder/remove",payload:u})},_=[{title:"\u7F16\u53F7",key:"index",render:function(u,l){return"".concat(l.index+1)}},B()({title:"\u8BF7\u6C42\u5730\u5740",key:"url",dataIndex:"url",width:"20%"},W("url")),{title:"\u8BF7\u6C42\u65B9\u5F0F",key:"request_method",dataIndex:"request_method",render:function(u){return(0,e.jsx)(ur,{fontColor:qe(u).fontColor,color:qe(u).color,text:u})}},{title:"\u8BF7\u6C42headers",key:"request_headers",dataIndex:"request_headers",render:function(u,l){return(0,e.jsx)(Ce,{name:"request_headers",record:l})}},{title:"\u8BF7\u6C42\u53C2\u6570",key:"body",dataIndex:"body",render:function(u,l){return u?(0,e.jsx)(Ce,{name:"body",record:l}):"-"}},{title:"\u8FD4\u56DEheaders",key:"response_headers",dataIndex:"response_headers",render:function(u,l){return u?(0,e.jsx)(Ce,{name:"response_headers",record:l}):"-"}},{title:"response",key:"response_content",dataIndex:"response_content",render:function(u,l){return u?(0,e.jsx)(Ce,{name:"response_content",record:l}):"-"}},{key:"ops",title:"\u64CD\u4F5C",render:function(u,l){return(0,e.jsx)(ye.Z,{title:"\u70B9\u51FB\u53EF\u5220\u9664\u5F55\u5236\u6570\u636E(\u4E0D\u63A8\u8350)",children:(0,e.jsx)(nr.Z,{twoToneColor:"#F56C6C",onClick:function(){Q(l.index)}})})}}];return(0,e.jsx)(ke.Z,{columns:_,dataSource:o,rowSelection:$.rowSelection,rowKey:function(u){return u[$.rowKey]},loading:O,locale:{emptyText:(0,e.jsx)(Ve.Z,{desc:$.emptyText,height:150})}})},lr=ir,cr=t(89959),dr=t(95996),hr=t(63446),Oe;(function(c){c[c.har=1]="har"})(Oe||(Oe={}));var fr=function(a){var o=a.visible,C=a.setVisible,O=a.directory,$=a.loading,V=a.recorder,f=a.dispatch,k=z.Z.useForm(),R=d()(k,1),U=R[0],J=V.recordLists,X=(0,i.useState)([]),H=d()(X,2),v=H[0],I=H[1],q=(0,i.useState)([]),W=d()(q,2),Q=W[0],_=W[1],D={selectedRowKeys:Q,onChange:function(A){_(A)}};(0,i.useEffect)(function(){f({type:"recorder/queryRecordStatus"}),I([]),U.resetFields()},[o]);var u=function(){if(J.length===0){Pe.Z.info({message:"\u{1F914}\u672A\u80FD\u83B7\u53D6\u5230\u5F55\u5236\u4FE1\u606F",description:(0,e.jsxs)("span",{children:["\u4F60\u53EF\u4EE5\u53BB",(0,e.jsx)("a",{href:"/#/apiTest/record",children:"\u5F55\u5236\u9875\u9762"})," \u76F4\u63A5\u751F\u6210\u7528\u4F8B\u54E6\u{1F389}~"]})});return}I(J)},l=function(){var E=M()(h()().mark(function A(){var L,P;return h()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,U.validateFields();case 2:return L=F.sent,F.next=5,f({type:"recorder/generateCase",payload:{directory_id:L.directory_id,name:L.name,requests:Q.map(function(S){return{request_headers:JSON.parse(v[S].request_headers),response_headers:JSON.parse(v[S].response_headers),cookies:JSON.parse(v[S].cookies),request_cookies:JSON.parse(v[S].request_cookies),response_content:v[S].response_content,request_method:v[S].request_method,url:v[S].url,body:v[S].body,status_code:v[S].status_code}})}});case 5:P=F.sent,P&&(Pe.Z.success({message:"\u{1F389} \u7528\u4F8B\u751F\u6210\u6210\u529F\uFF0C\u53EF\u4EE5\u53BB\u5BF9\u5E94\u76EE\u5F55\u67E5\u770B\u54E6~",placement:"topLeft"}),f({type:"testcase/save",payload:{currentDirectory:[L.directory_id]}}),C(!1));case 7:case"end":return F.stop()}},A)}));return function(){return E.apply(this,arguments)}}(),y=function(){var E=M()(h()().mark(function A(L){var P;return h()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return _([]),F.next=3,f({type:"recorder/import",payload:{file:L.file,import_type:Oe.har}});case 3:P=F.sent,P.length>0&&(Pe.Z.success({message:"\u{1F389} \u6210\u529F\u5BFC\u5165".concat(P.length,"\u6761\u6570\u636E\uFF0C\u5FEB\u53BB\u6311\u9009\u8BF7\u6C42\u751F\u6210\u7528\u4F8B\u5427~"),placement:"topLeft"}),I(P));case 5:case"end":return F.stop()}},A)}));return function(L){return E.apply(this,arguments)}}();return(0,e.jsxs)($e.Z,{title:"\u751F\u6210\u7528\u4F8B",onClose:function(){return C()},open:o,width:960,extra:(0,e.jsxs)(N.ZP,{disabled:Q.length===0,onClick:l,type:"primary",children:[(0,e.jsx)(cr.Z,{})," \u751F\u6210\u7528\u4F8B"]}),children:[(0,e.jsx)(z.Z,B()(B()({form:U},je.Z.SUB_LAYOUT),{},{children:(0,e.jsxs)(re.Z,{gutter:8,children:[(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(z.Z.Item,{label:"\u573A\u666F\u76EE\u5F55",name:"directory_id",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u573A\u666F\u76EE\u5F55"}],children:(0,e.jsx)(Ne.Z,{placeholder:"\u8BF7\u9009\u62E9\u573A\u666F\u76EE\u5F55",treeLine:!0,treeData:O})})}),(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(z.Z.Item,{label:"\u573A\u666F\u540D\u79F0",name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0"}],children:(0,e.jsx)(me.Z,{placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0"})})})]})})),v.length===0?(0,e.jsx)(oe.Z,{image:qt.Z,imageStyle:{height:220},description:"\u5F53\u524D\u6CA1\u6709\u4EFB\u4F55\u8BF7\u6C42\u6570\u636E\uFF0C\u4F60\u53EF\u4EE5\u9009\u62E9\u3010\u5F55\u5236\u3011\u540E\u7684\u6570\u636E\uFF0C\u4E5F\u53EF\u4EE5\u5BFC\u5165har\u6587\u4EF6\u63D0\u53D6\u63A5\u53E3\u{1F44F}",children:(0,e.jsxs)(Ye.Z,{children:[(0,e.jsxs)(N.ZP,{onClick:u,children:[(0,e.jsx)(dr.Z,{})," \u5F55\u5236\u8BF7\u6C42"]}),(0,e.jsx)(Yt.Z,{showUploadList:!1,customRequest:y,fileList:[],children:(0,e.jsxs)(N.ZP,{type:"primary",children:[(0,e.jsx)(hr.Z,{}),"\u5BFC\u5165Har"]})})]})}):(0,e.jsx)(lr,{dataSource:v,rowSelection:D,rowKey:"index",dispatch:f,loading:$.effects["recorder/generateCase"]})]})},vr=(0,ge.connect)(function(c){var a=c.recorder,o=c.loading;return{recorder:a,loading:o}})(fr),pr=t(56012),yr=le.Z.Option,mr=function(a){var o=a.testcase,C=a.gconfig,O=a.project,$=a.user,V=a.loading,f=a.dispatch,k=O.projects,R=O.project_id,U=C.envList,J=$.userList,X=$.userMap,H=o.directory,v=o.currentDirectory,I=o.testcases,q=o.asserts,W=o.testData,Q=o.preConstructor,_=o.outParameters,D=o.postConstructor,u=o.testResult,l=o.selectedRowKeys,y=o.pagination,E=(0,i.useState)(null),A=d()(E,2),L=A[0],P=A[1],b=(0,i.useState)(!1),F=d()(b,2),S=F[0],g=F[1],j=(0,i.useState)(!1),Z=d()(j,2),w=Z[0],K=Z[1],ne=(0,i.useState)({}),_e=d()(ne,2),Re=_e[0],Fe=_e[1],xr=(0,i.useState)("\u65B0\u5EFA\u76EE\u5F55"),et=d()(xr,2),jr=et[0],Se=et[1],Cr=(0,i.useState)(!1),tt=d()(Cr,2),Fr=tt[0],Ze=tt[1],Sr=z.Z.useForm(),Zr=d()(Sr,1),Le=Zr[0],Er=z.Z.useForm(),Dr=d()(Er,1),rt=Dr[0],Tr=(0,i.useState)(!1),nt=d()(Tr,2),Br=nt[0],st=nt[1],Ar=(0,i.useState)(""),at=d()(Ar,2),Pr=at[0],Or=at[1],Rr=(0,i.useState)(!1),ot=d()(Rr,2),Lr=ot[0],Me=ot[1],Mr=(0,i.useState)(!1),ut=d()(Mr,2),Ir=ut[0],it=ut[1],wr=(0,i.useState)(0),lt=d()(wr,2),Ie=lt[0],Kr=lt[1],Nr=(0,i.useState)([]),ct=d()(Nr,2),dt=ct[0],$r=ct[1],kr=(0,i.useState)([]),ht=d()(kr,2),ft=ht[0],Hr=ht[1],Ur=(0,i.useState)(""),vt=d()(Ur,2),pt=vt[0],zr=vt[1],Vr={selectedRowKeys:l,onChange:function(r){ce({selectedRowKeys:r})}},Wr=function(){var s=M()(h()().mark(function r(n,x){var m;return h()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,f({type:"testcase/executeTestcase",payload:{case_id:n.id,env:x}});case 2:m=T.sent,m&&(st(!0),Or(n.name));case 4:case"end":return T.stop()}},r)}));return function(n,x){return s.apply(this,arguments)}}(),br=function(){var s=M()(h()().mark(function r(n){var x;return h()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,f({type:"testcase/executeSelectedCase",payload:{case_list:l,env:n}});case 2:x=p.sent,Kt.Z.response(x)&&Y.Z.confirm({title:"\u7528\u4F8B\u6B63\u5728\u540E\u53F0\u6267\u884C, \u53BB\u62A5\u544A\u9875\u9762\u67E5\u770B\u4EFB\u52A1\u72B6\u6001\u{1F514}",icon:(0,e.jsx)(At.Z,{}),onOk:function(){ge.history.push("/#/record/list")},onCancel:function(){}});case 4:case"end":return p.stop()}},r)}));return function(n){return s.apply(this,arguments)}}(),yt=function(r){return U.length===0?(0,e.jsx)(ae.Z,{children:(0,e.jsx)("div",{children:(0,e.jsx)(oe.Z,{image:$t.Z,imageStyle:{height:90,width:90,margin:"0 auto"},description:(0,e.jsxs)("p",{children:["\u8FD8\u6CA1\u6709\u4EFB\u4F55\u73AF\u5883, \u53BB",(0,e.jsx)("a",{href:"/#/config/environment",children:"\u6DFB\u52A0\u4E00\u4E2A"}),"?"]})})})}):(0,e.jsx)(te.Z,{children:U.map(function(n){return(0,e.jsx)(te.Z.Item,{children:(0,e.jsx)("a",{onClick:M()(h()().mark(function x(){return h()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!r){p.next=5;break}return p.next=3,Wr(r,n.id);case 3:p.next=7;break;case 5:return p.next=7,br(n.id);case 7:case"end":return p.stop()}},x)})),children:n.name})},n.id)})})},Gr=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",ellipsis:!0,fixed:"left",width:"20%"},{title:"\u8BF7\u6C42\u534F\u8BAE",dataIndex:"request_type",key:"request_type",width:110,render:function(r){return Te.XN[r]}},{title:"\u4F18\u5148\u7EA7",dataIndex:"priority",key:"priority",width:90,render:function(r){return(0,e.jsx)(Be.Z,{color:je.Z.CASE_TAG[r],children:r})}},{title:"\u72B6\u6001",dataIndex:"status",key:"status",width:110,render:function(r){return(0,e.jsx)(Ft.Z,B()({},je.Z.CASE_BADGE[r]))}},{title:"\u521B\u5EFA\u4EBA",dataIndex:"create_user",key:"create_user",width:160,ellipsis:!0,render:function(r){return(0,e.jsx)(Nt.Z,{user:X[r]})}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updated_at",key:"updated_at",width:160},{title:"\u64CD\u4F5C",dataIndex:"ops",width:130,key:"ops",fixed:"right",render:function(r,n){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("a",{href:"/#/apiTest/testcase/".concat(v[0],"/").concat(n.id),children:"\u8BE6\u60C5"}),(0,e.jsx)(St.Z,{type:"vertical"}),(0,e.jsx)(pe.Z,{overlay:yt(n),children:(0,e.jsxs)("a",{onClick:function(m){m.stopPropagation()},children:["\u6267\u884C ",(0,e.jsx)(He.Z,{})]})})]})}}],Jr=function(){f({type:"project/listProject"})},we=function(){R&&f({type:"testcase/listTestcaseDirectory",payload:{project_id:R,move:!0}})},Xr=function(){f({type:"user/fetchUserList"})},Qr=function(){f({type:"gconfig/fetchEnvList"})},ue=function(){var s=M()(h()().mark(function r(){var n;return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Le.getFieldsValue();case 2:n=m.sent,v.length>0&&f({type:"testcase/listTestcase",payload:{directory_id:v[0],name:n.name||"",create_user:n.create_user!==null&&n.create_user!==void 0?n.create_user:""}});case 4:case"end":return m.stop()}},r)}));return function(){return s.apply(this,arguments)}}();(0,i.useEffect)(function(){Jr(),Xr(),Qr()},[]),(0,i.useEffect)(function(){we()},[R]),(0,i.useEffect)(function(){ue()},[v]);var mt=function(r){f({type:"project/save",payload:r}),f({type:"testcase/save",payload:{currentDirectory:[]}}),localStorage.setItem("project_id",r.project_id)},ce=function(r){f({type:"testcase/save",payload:r})},Yr=function(){var s=M()(h()().mark(function r(n){var x,m;return h()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(x={name:n.name,project_id:R,parent:L},!Re.id){T.next=7;break}return T.next=4,f({type:"testcase/updateTestcaseDirectory",payload:B()(B()({},x),{},{id:Re.id})});case 4:m=T.sent,T.next=10;break;case 7:return T.next=9,f({type:"testcase/insertTestcaseDirectory",payload:x});case 9:m=T.sent;case 10:m&&(g(!1),ce({selectedRowKeys:[]}),we());case 11:case"end":return T.stop()}},r)}));return function(n){return s.apply(this,arguments)}}(),qr=function(){var s=M()(h()().mark(function r(n){var x;return h()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,f({type:"testcase/moveTestCaseToDirectory",payload:{id_list:l,directory_id:n.directory_id,project_id:R}});case 2:x=p.sent,x&&(Me(!1),ce({selectedRowKeys:[]}),ue());case 4:case"end":return p.stop()}},r)}));return function(n){return s.apply(this,arguments)}}(),_r=function(){var s=M()(h()().mark(function r(n){var x;return h()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,f({type:"testcase/deleteTestcaseDirectory",payload:{id:n}});case 2:x=p.sent,x&&we();case 4:case"end":return p.stop()}},r)}));return function(n){return s.apply(this,arguments)}}(),en=function(){var s=M()(h()().mark(function r(){var n;return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,f({type:"testcase/deleteTestcase",payload:l});case 2:n=m.sent,n&&ue();case 4:case"end":return m.stop()}},r)}));return function(){return s.apply(this,arguments)}}(),tn=function(){Me(!0)},Ke=function(r,n){r===1?(P(n.key),Se("\u65B0\u589E\u76EE\u5F55"),Fe({name:""}),g(!0)):r===2?(Fe({name:n.title.props.children[2],id:n.key}),Se("\u7F16\u8F91\u76EE\u5F55"),g(!0)):r===3&&Y.Z.confirm({title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u76EE\u5F55\u5417?",icon:(0,e.jsx)(Pt.Z,{}),content:"\u5220\u9664\u540E\uFF0C\u76EE\u5F55\u4E0B\u7684case\u4E5F\u5C06\u4E0D\u518D\u53EF\u89C1\uFF01\uFF01\uFF01",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u70B9\u9519\u4E86",onOk:function(){_r(n.key)}})},rn=[{name:"name",label:"\u76EE\u5F55\u540D\u79F0",required:!0,placeholder:"\u8BF7\u8F93\u5165\u76EE\u5F55\u540D\u79F0, \u4E0D\u8D85\u8FC718\u4E2A\u5B57\u7B26",type:"input"}],nn=[{name:"directory_id",label:"\u76EE\u6807\u76EE\u5F55",required:!0,placeholder:"\u8BF7\u9009\u62E9\u8981\u79FB\u52A8\u5230\u7684\u76EE\u5F55",type:"select",component:(0,e.jsx)(Ne.Z,{treeData:H,showSearch:!0,treeDefaultExpandAll:!0})}],gt=function(){if(k.length===0)return"loading...";var r=k.filter(function(n){return n.id===R});return r.length===0?(mt({project_id:k[0].id}),k[0]):r[0]},xt={labelCol:{span:8},wrapperCol:{span:16}},sn=function(r){return(0,e.jsxs)(te.Z,{children:[(0,e.jsx)(te.Z.Item,{children:(0,e.jsxs)("a",{onClick:function(x){x.stopPropagation(),Ke(2,r)},children:[(0,e.jsx)(Ot.Z,{})," \u7F16\u8F91\u76EE\u5F55"]})},"1"),(0,e.jsx)(te.Z.Item,{danger:!0,children:(0,e.jsxs)("a",{onClick:function(x){x.stopPropagation(),Ke(3,r)},children:[(0,e.jsx)(Ue.Z,{})," \u5220\u9664\u76EE\u5F55"]})},"2")]})},an=(0,e.jsx)(ye.Z,{title:"\u70B9\u51FB\u53EF\u65B0\u5EFA\u6839\u76EE\u5F55, \u5B50\u76EE\u5F55\u9700\u8981\u5728\u6811\u4E0A\u65B0\u5EFA",children:(0,e.jsx)("a",{className:"directoryButton",onClick:function(){g(!0),Fe({name:""}),Se("\u65B0\u5EFA\u6839\u76EE\u5F55"),P(null)},children:(0,e.jsx)(Ae.Z,{})})}),on=function(){if(!v[0]){Zt.ZP.info("\u8BF7\u5148\u521B\u5EFA\u6216\u9009\u62E9\u7528\u4F8B\u76EE\u5F55~");return}Ze(!0),f({type:"testcase/save",payload:{asserts:[],postConstructor:[],preConstructor:[],outParameters:[{key:0,source:1}],caseInfo:{},testData:{}}})},un=(0,e.jsxs)(te.Z,{children:[(0,e.jsx)(te.Z.Item,{children:(0,e.jsxs)("a",{onClick:function(){on()},children:[(0,e.jsx)(Rt.Z,{})," \u666E\u901A\u573A\u666F"]})},"1"),(0,e.jsx)(te.Z.Item,{children:(0,e.jsxs)("a",{onClick:function(){return it(!0)},children:[(0,e.jsx)(Lt.Z,{})," \u5F55\u5236\u573A\u666F",(0,e.jsx)(Be.Z,{color:"red",style:{fontSize:12,margin:"0 4px",lineHeight:"12px",padding:2},children:"\u65B0"})]})},"2")]}),ln=function(){return _.filter(function(r){switch(r.source){case 0:case 5:return r.name&&r.expression&&r.match_index;case 1:case 2:case 3:case 6:case 7:return r.name&&r.expression;case 4:return r.name;default:return!1}})},jt=function(){var s=M()(h()().mark(function r(){var n,x,m,p,T;return h()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,rt.validateFields();case 2:return n=ee.sent,x=B()(B()({},n),{},{request_type:parseInt(n.request_type,10),status:parseInt(n.status,10),tag:n.tag?n.tag.join(","):null,directory_id:v[0],body_type:Ie,request_headers:Qe.Z.translateHeaders(ft),body:Ie===2?JSON.stringify(dt):pt}),m=[],Object.values(W).forEach(function(cn){m=m.concat(cn)}),p={case:x,asserts:q,data:m,constructor:[].concat(fe()(Q),fe()(D)),out_parameters:ln()},ee.next=9,f({type:"testcase/createTestCase",payload:p});case 9:if(T=ee.sent,!T){ee.next=14;break}return Ze(!1),ee.next=14,ue();case 14:case"end":return ee.stop()}},r)}));return function(){return s.apply(this,arguments)}}();return(0,e.jsxs)(De._z,{title:!1,breadcrumb:null,children:[(0,e.jsx)(be.Z,{width:1e3,modal:Br,setModal:st,response:u,caseName:Pr,single:!1}),(0,e.jsx)(We.Z,{title:"\u79FB\u52A8\u7528\u4F8B",onCancel:function(){return Me(!1)},fields:nn,onFinish:qr,open:Lr,left:6,right:18,width:500,formName:"move"}),k.length===0?(0,e.jsx)(Et.ZP,{status:"404",subTitle:(0,e.jsxs)("span",{children:["\u4F60\u8FD8\u6CA1\u6709\u6DFB\u52A0\u4EFB\u4F55\u9879\u76EE, ",(0,e.jsx)("a",{href:"/#/project",children:"\u6DFB\u52A0\u9879\u76EE"}),"\u540E\u624D\u80FD\u7F16\u5199Case"]})}):(0,e.jsx)(ae.Z,{style:{height:"100%",minHeight:600},bodyStyle:{padding:0},bordered:!1,children:(0,e.jsxs)(re.Z,{children:[(0,e.jsx)(We.Z,{title:jr,onCancel:function(){return g(!1)},fields:rn,onFinish:Yr,record:Re,open:S,left:6,right:18,width:400,formName:"root"}),(0,e.jsx)($e.Z,{bodyStyle:{padding:0},open:Fr,width:1300,title:"\u6DFB\u52A0\u573A\u666F\u7528\u4F8B",onClose:function(){return Ze(!1)},maskClosable:!1,footer:(0,e.jsxs)("div",{style:{float:"right"},children:[(0,e.jsxs)(N.ZP,{type:"primary",onClick:M()(h()().mark(function s(){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,jt();case 2:case"end":return n.stop()}},s)})),children:[(0,e.jsx)(Mt.Z,{})," \u63D0\u4EA4"]}),(0,e.jsxs)(N.ZP,{style:{marginLeft:8},children:[(0,e.jsx)(ze.Z,{})," \u6D4B\u8BD5"]})]}),children:(0,e.jsx)(Qt,{directory_id:v[0],onSubmit:jt,bodyType:Ie,setBodyType:Kr,formData:dt,setFormData:$r,setAddCaseVisible:Ze,headers:ft,setHeaders:Hr,body:pt,form:rt,setBody:zr})}),(0,e.jsx)(vr,{directory:H,visible:Ir,setVisible:it}),(0,e.jsxs)(Bt.Z,{className:"pitySplit",split:"vertical",minSize:260,defaultSize:300,maxSize:800,children:[(0,e.jsxs)(Xe,{className:"card",hideOverflowX:!0,children:[(0,e.jsx)(re.Z,{gutter:8,children:(0,e.jsx)(G.Z,{span:24,children:(0,e.jsx)("div",{style:{height:40,lineHeight:"40px"},children:w?(0,e.jsx)(le.Z,{style:{marginLeft:32,width:150},showSearch:!0,allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u9879\u76EE",value:R,autoFocus:!0,onChange:function(r){r!==void 0&&mt({project_id:r}),K(!1)},filterOption:function(r,n){return n.children.toLowerCase().indexOf(r.toLowerCase())>=0},children:k.map(function(s){return(0,e.jsx)(yr,{value:s.id,children:s.name},s.id)})}):(0,e.jsxs)("div",{onClick:function(){return K(!0)},children:[(0,e.jsx)(Dt.C,{style:{marginLeft:8,marginRight:6},size:"large",src:gt().avatar||je.Z.PROJECT_AVATAR_URL}),(0,e.jsx)("span",{style:{display:"inline-block",marginLeft:12,fontWeight:400,fontSize:14},children:gt().name}),(0,e.jsx)(pr.Z,{style:{marginLeft:12,cursor:"pointer",lineHeight:"40px"},theme:"outline",size:"16",fill:"#7ed321"})]})})})}),(0,e.jsx)("div",{style:{marginTop:24},children:(0,e.jsx)(Tt.Z,{spinning:V.effects["testcase/listTestcaseDirectory"],children:H.length>0?(0,e.jsx)(Vt,{treeData:H,menu:sn,addDirectory:an,onSelect:function(r){ce({currentDirectory:r[0]===v[0]?[]:r,selectedRowKeys:[]})},onAddNode:function(r){P(r.key),Ke(1,r)},selectedKeys:v}):(0,e.jsx)(Ve.Z,{height:180,desc:(0,e.jsxs)("span",{children:["\u8FD8\u6CA1\u6709\u76EE\u5F55\uFF0C",(0,e.jsx)("a",{onClick:function(){g(!0),Fe({name:""}),Se("\u65B0\u5EFA\u6839\u76EE\u5F55"),P(null)},children:"\u6DFB\u52A0"}),"\u4E00\u4E2A\u5427~"]})})})})]}),(0,e.jsx)(Xe,{className:"card",hideOverflowX:!0,children:v.length>0?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.Z,{form:Le,children:(0,e.jsxs)(re.Z,{gutter:6,children:[(0,e.jsx)(G.Z,{span:8,children:(0,e.jsx)(z.Z.Item,B()(B()({label:"\u7528\u4F8B\u540D\u79F0"},xt),{},{name:"name",children:(0,e.jsx)(me.Z,{placeholder:"\u8F93\u5165\u7528\u4F8B\u540D\u79F0"})}))}),(0,e.jsx)(G.Z,{span:8,children:(0,e.jsx)(z.Z.Item,B()(B()({label:"\u521B\u5EFA\u4EBA"},xt),{},{name:"create_user",children:(0,e.jsx)(kt.Z,{users:J,placeholder:"\u8BF7\u9009\u62E9\u521B\u5EFA\u7528\u6237"})}))}),(0,e.jsx)(G.Z,{span:8,children:(0,e.jsxs)("div",{style:{float:"right"},children:[(0,e.jsxs)(N.ZP,{type:"primary",onClick:M()(h()().mark(function s(){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ue();case 2:case"end":return n.stop()}},s)})),children:[(0,e.jsx)(xe.Z,{})," \u67E5\u8BE2"]}),(0,e.jsxs)(N.ZP,{style:{marginLeft:8},onClick:M()(h()().mark(function s(){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Le.resetFields(),n.next=3,ue();case 3:case"end":return n.stop()}},s)})),children:[(0,e.jsx)(It.Z,{})," \u91CD\u7F6E"]})]})})]})}),(0,e.jsx)(re.Z,{gutter:8,style:{marginTop:4},children:(0,e.jsxs)(G.Z,{span:24,children:[(0,e.jsx)(pe.Z,{overlay:un,trigger:"click",children:(0,e.jsxs)(N.ZP,{type:"primary",children:[(0,e.jsx)(Ae.Z,{})," \u65B0\u5EFA\u573A\u666F"]})}),l.length>0?(0,e.jsx)(pe.Z,{overlay:yt(),trigger:["hover"],children:(0,e.jsxs)(N.ZP,{style:{marginLeft:8},icon:(0,e.jsx)(ze.Z,{}),onClick:function(r){r.stopPropagation()},children:["\u6267\u884C\u7528\u4F8B ",(0,e.jsx)(He.Z,{})]})}):null,l.length>0?(0,e.jsx)(N.ZP,{type:"dashed",style:{marginLeft:8},icon:(0,e.jsx)(wt.Z,{}),onClick:function(r){r.stopPropagation(),tn()},children:"\u79FB\u52A8\u7528\u4F8B"}):null,l.length>0?(0,e.jsx)(N.ZP,{danger:!0,style:{marginLeft:8},icon:(0,e.jsx)(Ue.Z,{}),onClick:function(r){r.stopPropagation(),en()},children:"\u5220\u9664\u7528\u4F8B"}):null]})}),(0,e.jsx)(re.Z,{style:{marginTop:16},children:(0,e.jsx)(G.Z,{span:24,children:(0,e.jsx)(ke.Z,{columns:Gr,rowKey:function(r){return r.id},rowSelection:Vr,pagination:y,bordered:!0,onChange:function(r){ce({pagination:B()(B()({},y),{},{current:r.current})})},dataSource:I,scroll:{x:1100},loading:V.effects["testcase/listTestcase"]||V.effects["testcase/executeTestcase"]})})})]}):(0,e.jsx)(oe.Z,{image:bt.Z,imageStyle:{height:230},description:"\u5FEB\u9009\u4E2D\u5DE6\u4FA7\u7684\u76EE\u5F55\u7545\u4EAB\u7528\u4F8B\u4E4B\u65C5\u5427~"})})]})]})})]})},gr=(0,ge.connect)(function(c){var a=c.testcase,o=c.gconfig,C=c.project,O=c.user,$=c.loading;return{loading:$,gconfig:o,user:O,project:C,testcase:a}})((0,i.memo)(mr))}}]);
